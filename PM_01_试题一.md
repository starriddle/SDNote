# 下午题 01 数据流图

<!-- TOC -->

- [下午题 01 数据流图](#下午题-01-数据流图)
  - [说明](#说明)
  - [数据流图](#数据流图)
    - [外部实体 External Agent](#外部实体-external-agent)
    - [数据存储 Data Store](#数据存储-data-store)
    - [加工 Process](#加工-process)
    - [数据流 Data Flow](#数据流-data-flow)
  - [问题](#问题)
    - [一、给出外部实体名称](#一给出外部实体名称)
    - [二、给出数据存储名称](#二给出数据存储名称)
    - [三、补充缺失的数据流](#三补充缺失的数据流)
    - [四、扩展题](#四扩展题)

<!-- /TOC -->

## 说明

下午题 试题一：

- 教程：6.2 结构化分析方法，P325-337
- 分值：15 分
- 题型：数据流图（大概率）
- 结构：
  - 文字说明：系统简介 + 功能描述
  - 数据流图：上下文数据流图 + 0 层数据流图
  - 问题：
    1. 给出外部实体的名称
    2. 给出数据存储的名称
    3. 补充缺失的数据流
    4. 扩展题（分解加工、结构化语言、问题简答）

## 数据流图

概念

- 数据流图，即数据流程图（Data Flow Diagram, DFD）
- 一种便于用户理解、分析系统数据流程的图形工具
- 摆脱了系统的物理内容，精确地在逻辑上描述系统的功能、输入、输出和数据存储等
- 是系统逻辑模型的重要组成部分

基本图形元素

- 数据流 Data Flow
- 加工 Process
- 数据存储 Data Store

> 以上，用于构建软件系统内部的数据处理模型

- 外部实体 External Agent

> 表示存在于系统之外的对象，用来帮助用户理解系统数据的来源和去向

### 外部实体 External Agent

定义：当前系统之外的人、物、外部系统

> 作图：直角矩形（多数使用正方形）

### 数据存储 Data Store

定义：存储数据和提供数据

存储加工的输出数据和提供加工的输入数据

如：数据表、数据文件等

> 作图：直角矩形，但右边缺失或左右两边均缺失

### 加工 Process

定义：将输入数据处理后得到输出数据

一个加工至少有一个输入数据流，和一个输出数据流

常见三个问题：

- 只有输入，没有输出 --> 黑洞
- 只有输出，没有输入 --> （白洞）
- 输入数据不足以产生输出数据 --> 灰洞

> 作图：圆角矩形，或右侧开口的圆形

### 数据流 Data Flow

数据流由一组固定成分的数据组成，表示数据的流向

在 DFD 中，数据流的流向可以有以下几种：

- 从一个加工流向另一个加工
- 从加工流向数据存储(写)
- 从数据存储流向加工（读）
- 从外部实体流向加工（输入）
- 从加工流向外部实体（输出）

由此可知：**数据流的起点或终点至少有一个是加工**

> 作图：带箭头线条(或折线)
>
> ```text
>       名称
> 起点 ------> 终点
> ```

## 问题

### 一、给出外部实体名称

问题一：**给出上下文数据流图（父图）中的外部实体的名称**

父图和子图中都有外部实体，应该结合说明和子图来寻找实体名称

先通过数据流较少的加工的说明来寻找实体名称，再通过数据流较多的加工的说明来验证实体名称

一般文字说明中都有给出每个实体名称，只需找出来，并使用该名称即可

### 二、给出数据存储名称

问题二：**给出0层数据流图（子图）中的数据存储的名称**

结合说明和子图来寻找数据存储的名称

先通过数据流较少的加工的说明来寻找数据存储名称，再通过数据流较多的加工的说明来验证数据存储

如果文字说明中给出了数据存储的名称，直接使用该名称即可，否则需要结合上下文并根据具体情况进行判断，名称一般为 `XX表/文件`

### 三、补充缺失的数据流

问题三：**补充0层数据流图（子图）中缺失的数据流及其起点和终点**

> 如问题中未指明数据流条数，一般情况下在 [分值/2，分值] 范围内，但也有可能超出范围

按以下三个解题方法一次查找：

1. **父图子图平衡**
   - 父图中的每一条数据流，在子图中都必须存在
     - 父图数据流：系统-实体（名称+起点+终点）
     - 子图数据流：加工-实体（名称+起点+终点）
   - 只能确定系统和指定实体间是否缺少数据流
     - 可以确定实体名称、数据流方向
     - 可以确定数据流名称，但也可能是概括性名称，在子图中需要细化
       - 父图中一条数据流，在子图中可能会分为多条
     - 无法确定具体数据流条数，以及每条数据流另一端的加工名称
2. **加工既有输入数据流也有输出数据流**
   - 一个加工至少有一个输入数据流，和一个输出数据流
   - 只能确定指定加工是否缺少输入/输出数据流
     - 可以确定加工名称、数据流方向
     - 无法确定具体数据流条数，以及每条数据流名称和另一端是哪个实体或数据存储
3. **数据守恒**
   - **加工和功能描述一致**
   - 阅读说明文档，特别是具体的功能描述（即对加工的描述），确定对应的数据流
   - 解题重要方法
     - 可找到所有缺失的数据流名称及起点和终点
     - 对照数据流图仔细阅读，避免出现遗漏，利用方法1/2进行校验和查漏补缺

> 注意：数据流的起点和终点至少有一端为加工

### 四、扩展题

- 分解加工：将一个较复杂的加工分解为多个加工

- 一些简答题：
  - 加工的注意事项：黑洞、白洞、灰洞
  - 数据流图存在哪些问题：即查找数据流缺失三个原则

- 数据流的组成
  - 数据流由具体的数据属性构成，采用符号加以表示
  - 描述举例：`学生信息=学生ID+学生卡ID+1{家长ID}*+班主任ID+班级`

| 符号  |     含义     | 举例及说明                             |
| :---: | :----------: | -------------------------------------- |
|   =   |   被定义为   | x=a+b 表示 x 由 a 和 b 组成            |
|   +   |      与      | x=a+b 表示 x 由 a 和 b 组成            |
| [\|]  |      或      | x=[a\|b] 表示 x 由 a 或 b 组成         |
|  ()   |     可选     | x=(a) 表示 a 可在 x 中出现，也可不出现 |
|  “”   | 基本数据元素 | x=“a” 表示 x 是取值为字符 a 的数据元素 |
|  ..   |    连接符    | x=1..9 表示 x 可取 1~9 中的任意一个值  |
|  {}   |     重复     | x={a} 表示 x 由 0 个或多个 a 组成      |
| m{}n 或 $\{\}^n_m$ | 重复 | x=2{a}5 或 $x=\{a\}^5_2$ 表示 x 中 a 出现 2~5 次，* 可表示不确定的多次|

- 使用结构化语言描述加工逻辑
  - 结构化语言
    - 外层
      - 语法严格，用来描述控制结构
        - 顺序结构
          - 一组祈使语句、选择语句、重复语句的顺序排列
        - 选择结构
          - 使用 IF-THEN-ELSE-ENDIF、CASE-OF-ENDCASE 等关键字
        - 重复结构
          - 使用 DO-WHILE-ENDDO、REPEAT-UNTIL 等关键字
    - 内层
      - 语法比较灵活，接近自然语言
      - 一般采用祈使语句的自然语言短语，包含动词+名词，尽量不用形容词/副词修饰

```sh
# IF-THEN-ELSE-ENDIF
IF 条件1成立
THEN # 对于 THEN/ELSE 多个内层语句可以换行缩进书写
  执行动作1.1
  执行动作1.2
ELSE
  IF 条件2成立
  THEN 执行动作2 # 对于 THEN/ELSE 单个内层语句可以同行书写
  # 对于 ELSE 根据实际逻辑情况可以省略
  ENDIF
ENDIF
```

```sh
# REPEAT-UNTIL
REPEAT
  执行动作1
  执行动作2
UNTIL 条件成立
```
